{
  "config": {
    "model": "llama-7B-128K",
    "prefill_length": 8192,
    "gen_length": 256,
    "temperature": 0.6,
    "top_p": 0.9,
    "on_chip_layers": 16,
    "gamma": 8,
    "world_size": 1,
    "dataset": "demo",
    "gen_lens_sweep": [
      256,
      512,
      768,
      1024,
      1536,
      2048
    ],
    "resident_layers": 16,
    "num_samples": 1,
    "timestamp": "2025-12-15T05:13:32.802869"
  },
  "methods": {
    "triforce_kv_quant": {
      "name": "TriForce baseline vs TriForce with KV Cache Quantization",
      "retrieval_budget": 4096,
      "kv_cache_quant_bits": 8,
      "kv_fp16_tail": 0,
      "kv_resident_gpu": true,
      "sweep": {
        "256": {
          "gen_len": 256,
          "on_chip_layers": 16,
          "resident_layers": 16,
          "baseline": {
            "mean_latency_s": 13.622535561615566,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 18.792389921985983,
            "mean_accepted_tokens": 7.007518796992481,
            "mean_latency_s_per_token": 0.0532130295375608
          },
          "quant": {
            "mean_latency_s": 10.341893282803623,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 24.753688033667274,
            "mean_accepted_tokens": 6.925373134328358,
            "mean_latency_s_per_token": 0.04039802063595165
          },
          "speedup_vs_triforce_baseline": 1.317218732499102
        },
        "512": {
          "gen_len": 512,
          "on_chip_layers": 16,
          "resident_layers": 16,
          "baseline": {
            "mean_latency_s": 30.88153600692749,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 16.57948619800342,
            "mean_accepted_tokens": 6.854961832061068,
            "mean_latency_s_per_token": 0.060315500013530254
          },
          "quant": {
            "mean_latency_s": 20.78852298227454,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 24.62897438344032,
            "mean_accepted_tokens": 6.863636363636363,
            "mean_latency_s_per_token": 0.04060258394975496
          },
          "speedup_vs_triforce_baseline": 1.485508904757631
        },
        "768": {
          "gen_len": 768,
          "on_chip_layers": 16,
          "resident_layers": 16,
          "baseline": {
            "mean_latency_s": 35.05806535543855,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 21.906514013639384,
            "mean_accepted_tokens": 7.988439306358382,
            "mean_latency_s_per_token": 0.04564852259822728
          },
          "quant": {
            "mean_latency_s": 31.412994699379833,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 24.448480870725838,
            "mean_accepted_tokens": 6.556900726392252,
            "mean_latency_s_per_token": 0.040902336848150825
          },
          "speedup_vs_triforce_baseline": 1.1160370315196557
        },
        "1024": {
          "gen_len": 1024,
          "on_chip_layers": 16,
          "resident_layers": 16,
          "baseline": {
            "mean_latency_s": 50.845776201105444,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 20.139332635023028,
            "mean_accepted_tokens": 7.545923632610939,
            "mean_latency_s_per_token": 0.049654078321392035
          },
          "quant": {
            "mean_latency_s": 34.82734840482126,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 29.402180955534487,
            "mean_accepted_tokens": 7.3528816986855405,
            "mean_latency_s_per_token": 0.03401108242658326
          },
          "speedup_vs_triforce_baseline": 1.4599381959858506
        },
        "1536": {
          "gen_len": 1536,
          "on_chip_layers": 16,
          "resident_layers": 16,
          "baseline": {
            "mean_latency_s": 78.72650519036628,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 19.510582824499103,
            "mean_accepted_tokens": 7.551867219917012,
            "mean_latency_s_per_token": 0.051254235149978046
          },
          "quant": {
            "mean_latency_s": 56.34898674511275,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 27.258697781876624,
            "mean_accepted_tokens": 7.038961038961039,
            "mean_latency_s_per_token": 0.03668553824551611
          },
          "speedup_vs_triforce_baseline": 1.3971237059944897
        },
        "2048": {
          "gen_len": 2048,
          "on_chip_layers": 16,
          "resident_layers": 16,
          "baseline": {
            "mean_latency_s": 113.92108163207116,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 17.977357400927673,
            "mean_accepted_tokens": 7.198412698412699,
            "mean_latency_s_per_token": 0.05562552814065975
          },
          "quant": {
            "mean_latency_s": 63.45025120441123,
            "std_latency_s": 0.0,
            "mean_throughput_tok_per_s": 32.27725597810742,
            "mean_accepted_tokens": 7.871313672922252,
            "mean_latency_s_per_token": 0.03098156797090392
          },
          "speedup_vs_triforce_baseline": 1.7954394107134923
        }
      }
    }
  }
}