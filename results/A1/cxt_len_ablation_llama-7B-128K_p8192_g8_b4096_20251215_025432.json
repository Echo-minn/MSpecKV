{
  "config": {
    "model": "llama-7B-128K",
    "prefill_length": 8192,
    "prefill_lengths_sweep": [
      8192,
      16384,
      24576,
      32768
    ],
    "gen_length": 256,
    "temperature": 0.6,
    "top_p": 0.9,
    "on_chip_layers": 16,
    "gamma": 8,
    "world_size": 1,
    "dataset": "demo",
    "resident_layers": 16,
    "num_samples": 1,
    "timestamp": "2025-12-15T18:53:34.231624"
  },
  "methods": {
    "triforce_kv_quant": {
      "name": "TriForce with KV Cache Quantization",
      "retrieval_budget": 4096,
      "kv_cache_quant_bits": 8,
      "kv_fp16_tail": 0,
      "kv_resident_gpu": true,
      "sweep": {
        "8192": {
          "prefill_length": 8192,
          "resident_layers": 16,
          "mean_latency_s": 11.40704870223999,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 22.442264137061986,
          "mean_accepted_tokens": 6.096551724137931,
          "mean_latency_s_per_token": 0.04455878399312496,
          "speedup_vs_baseline": 4.752028033240094,
          "speedup_vs_vanilla": 4.047865727041885,
          "speedup_vs_triforce": 1.4632479339896662
        },
        "16384": {
          "prefill_length": 16384,
          "resident_layers": 16,
          "mean_latency_s": 12.40089750289917,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 20.643667116847833,
          "mean_accepted_tokens": 5.391304347826087,
          "mean_latency_s_per_token": 0.04844100587069988,
          "speedup_vs_baseline": 8.011314853667537,
          "speedup_vs_vanilla": 7.568687151210693,
          "speedup_vs_triforce": 2.128081361142361
        },
        "24576": {
          "prefill_length": 24576,
          "resident_layers": 16,
          "mean_latency_s": 11.414453637508945,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 22.42770509477216,
          "mean_accepted_tokens": 5.743589743589744,
          "mean_latency_s_per_token": 0.04458770952151932,
          "speedup_vs_baseline": 12.939747620714666,
          "speedup_vs_vanilla": 10.504388369867305,
          "speedup_vs_triforce": 2.8729795383565886
        },
        "32768": {
          "prefill_length": 32768,
          "resident_layers": 16,
          "mean_latency_s": 13.533040519889074,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 18.91666544733721,
          "mean_accepted_tokens": 5.215339233038348,
          "mean_latency_s_per_token": 0.052863439530816694,
          "speedup_vs_baseline": 14.445949794735641,
          "speedup_vs_vanilla": 11.986616503657094,
          "speedup_vs_triforce": 3.687468674843401
        }
      }
    },
    "triforce": {
      "name": "TriForce (SpecDec + Retrieval)",
      "sweep": {
        "8192": {
          "prefill_length": 8192,
          "resident_layers": 16,
          "mean_latency_s": 16.691340446472168,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 15.337294258718892,
          "mean_accepted_tokens": 7.146245059288537,
          "mean_latency_s_per_token": 0.0652005486190319,
          "speedup_vs_baseline": 3.247589094681513,
          "speedup_vs_vanilla": 2.766356700743835
        },
        "16384": {
          "prefill_length": 16384,
          "resident_layers": 16,
          "mean_latency_s": 26.390118837356567,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 9.700600500427413,
          "mean_accepted_tokens": 6.225352112676056,
          "mean_latency_s_per_token": 0.10308640170842409,
          "speedup_vs_baseline": 3.7645716935216416,
          "speedup_vs_vanilla": 3.5565779060006415
        },
        "24576": {
          "prefill_length": 24576,
          "resident_layers": 16,
          "mean_latency_s": 32.793491742083134,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 7.806427019525984,
          "mean_accepted_tokens": 6.561151079136691,
          "mean_latency_s_per_token": 0.12809957711751224,
          "speedup_vs_baseline": 4.503947016662884,
          "speedup_vs_vanilla": 3.656269816622523
        },
        "32768": {
          "prefill_length": 32768,
          "resident_layers": 16,
          "mean_latency_s": 49.90266299247742,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 5.129986751179807,
          "mean_accepted_tokens": 5.134328358208955,
          "mean_latency_s_per_token": 0.1949322773143649,
          "speedup_vs_baseline": 3.9175789867148167,
          "speedup_vs_vanilla": 3.2506354794095
        }
      }
    },
    "baseline": {
      "name": "Autoregressive (No Speculation)",
      "sweep": {
        "8192": {
          "prefill_length": 8192,
          "mean_latency_s": 54.20661520957947,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 4.722670821821749,
          "mean_latency_ms_per_token": 211.7445906624198,
          "mean_accepted_tokens": null,
          "speedup_vs_baseline": 1.0
        },
        "16384": {
          "prefill_length": 16384,
          "mean_latency_s": 99.34749436378479,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 2.576813855642844,
          "mean_latency_ms_per_token": 388.07614985853434,
          "mean_accepted_tokens": null,
          "speedup_vs_baseline": 1.0
        },
        "24576": {
          "prefill_length": 24576,
          "mean_latency_s": 147.70014929771423,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 1.7332413082669902,
          "mean_latency_ms_per_token": 576.9537081941962,
          "mean_accepted_tokens": null,
          "speedup_vs_baseline": 1.0
        },
        "32768": {
          "prefill_length": 32768,
          "mean_latency_s": 195.49762392044067,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 1.3094788308229324,
          "mean_latency_ms_per_token": 763.6625934392214,
          "mean_accepted_tokens": null,
          "speedup_vs_baseline": 1.0
        }
      }
    },
    "vanilla_specdec": {
      "name": "Vanilla Speculative Decoding (No Retrieval)",
      "gamma": 8,
      "sweep": {
        "8192": {
          "prefill_length": 8192,
          "mean_latency_s": 46.17420148849487,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 5.544221486186111,
          "mean_accepted_tokens": 0.3473684210526316,
          "speedup_vs_baseline": 1.1739589091342708
        },
        "16384": {
          "prefill_length": 16384,
          "mean_latency_s": 93.8585135936737,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 2.7275096333643094,
          "mean_accepted_tokens": 0.14732142857142858,
          "speedup_vs_baseline": 1.0584814372180837
        },
        "24576": {
          "prefill_length": 24576,
          "mean_latency_s": 119.90185403823853,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 2.1350795786557035,
          "mean_accepted_tokens": 0.29949238578680204,
          "speedup_vs_baseline": 1.2318420801951102
        },
        "32768": {
          "prefill_length": 32768,
          "mean_latency_s": 162.21536684036255,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 1.5781488830952228,
          "mean_accepted_tokens": 0.2549019607843137,
          "speedup_vs_baseline": 1.2051732688977084
        }
      }
    }
  }
}