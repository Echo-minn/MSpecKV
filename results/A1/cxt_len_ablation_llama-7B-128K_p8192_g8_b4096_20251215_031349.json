{
  "config": {
    "model": "llama-7B-128K",
    "prefill_length": 8192,
    "prefill_lengths_sweep": [
      8192,
      16384,
      24576,
      32768
    ],
    "gen_length": 256,
    "temperature": 0.6,
    "top_p": 0.9,
    "on_chip_layers": 16,
    "gamma": 8,
    "world_size": 1,
    "dataset": "demo",
    "resident_layers": 16,
    "num_samples": 1,
    "timestamp": "2025-12-15T19:50:16.217904"
  },
  "methods": {
    "triforce_kv_quant": {
      "name": "TriForce with KV Cache Quantization",
      "retrieval_budget": 4096,
      "kv_cache_quant_bits": 8,
      "kv_fp16_tail": 0,
      "kv_resident_gpu": true,
      "sweep": {
        "8192": {
          "prefill_length": 8192,
          "resident_layers": 16,
          "mean_latency_s": 11.268766460996686,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 22.717659549167518,
          "mean_accepted_tokens": 6.925373134328358,
          "mean_latency_s_per_token": 0.0440186189882683,
          "speedup_vs_baseline": 4.800489546522757,
          "speedup_vs_vanilla": 4.064717123252203,
          "speedup_vs_triforce": 1.6032896809287234
        },
        "16384": {
          "prefill_length": 16384,
          "resident_layers": 16,
          "mean_latency_s": 10.840320528470553,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 23.615537873409977,
          "mean_accepted_tokens": 6.457142857142857,
          "mean_latency_s_per_token": 0.0423450020643381,
          "speedup_vs_baseline": 9.23089090412116,
          "speedup_vs_vanilla": 7.810393707223572,
          "speedup_vs_triforce": 2.35803551496977
        },
        "24576": {
          "prefill_length": 24576,
          "resident_layers": 16,
          "mean_latency_s": 13.812112497728924,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 18.53445662581254,
          "mean_accepted_tokens": 4.7162534435261705,
          "mean_latency_s_per_token": 0.05395356444425361,
          "speedup_vs_baseline": 10.75116337721535,
          "speedup_vs_vanilla": 9.28011368609736,
          "speedup_vs_triforce": 3.1287782593612765
        },
        "32768": {
          "prefill_length": 32768,
          "resident_layers": 16,
          "mean_latency_s": 15.238187367679508,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 16.799898427747447,
          "mean_accepted_tokens": 4.301507537688442,
          "mean_latency_s_per_token": 0.05952416940499808,
          "speedup_vs_baseline": 12.834308353839074,
          "speedup_vs_vanilla": 10.7432991565597,
          "speedup_vs_triforce": 3.564699405801266
        }
      }
    },
    "triforce": {
      "name": "TriForce (SpecDec + Retrieval)",
      "sweep": {
        "8192": {
          "prefill_length": 8192,
          "resident_layers": 16,
          "mean_latency_s": 18.067096983711675,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 14.169404206486291,
          "mean_accepted_tokens": 7.007518796992481,
          "mean_latency_s_per_token": 0.07057459759262373,
          "speedup_vs_baseline": 2.9941498430539513,
          "speedup_vs_vanilla": 2.535235629345329
        },
        "16384": {
          "prefill_length": 16384,
          "resident_layers": 16,
          "mean_latency_s": 25.56186079978943,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 10.014920353611693,
          "mean_accepted_tokens": 6.320284697508897,
          "mean_latency_s_per_token": 0.09985101874917746,
          "speedup_vs_baseline": 3.9146530429756914,
          "speedup_vs_vanilla": 3.312246002080974
        },
        "24576": {
          "prefill_length": 24576,
          "resident_layers": 16,
          "mean_latency_s": 43.21503729874644,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 5.923863914087746,
          "mean_accepted_tokens": 4.713513513513513,
          "mean_latency_s_per_token": 0.16880873944822827,
          "speedup_vs_baseline": 3.436217745712073,
          "speedup_vs_vanilla": 2.966050297214685
        },
        "32768": {
          "prefill_length": 32768,
          "resident_layers": 16,
          "mean_latency_s": 54.3195574550555,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 4.71285135582735,
          "mean_accepted_tokens": 4.3824289405684755,
          "mean_latency_s_per_token": 0.21218577130881056,
          "speedup_vs_baseline": 3.600390072989675,
          "speedup_vs_vanilla": 3.0138022687343096
        }
      }
    },
    "baseline": {
      "name": "Autoregressive (No Speculation)",
      "sweep": {
        "8192": {
          "prefill_length": 8192,
          "mean_latency_s": 54.095595598220825,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 4.732363091098302,
          "mean_latency_ms_per_token": 211.3109203055501,
          "mean_accepted_tokens": null,
          "speedup_vs_baseline": 1.0
        },
        "16384": {
          "prefill_length": 16384,
          "mean_latency_s": 100.06581616401672,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 2.558316214404261,
          "mean_latency_ms_per_token": 390.8820943906903,
          "mean_accepted_tokens": null,
          "speedup_vs_baseline": 1.0
        },
        "24576": {
          "prefill_length": 24576,
          "mean_latency_s": 148.49627804756165,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 1.7239489323631811,
          "mean_latency_ms_per_token": 580.0635861232877,
          "mean_accepted_tokens": null,
          "speedup_vs_baseline": 1.0
        },
        "32768": {
          "prefill_length": 32768,
          "mean_latency_s": 195.57159543037415,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 1.3089835435286363,
          "mean_latency_ms_per_token": 763.951544649899,
          "mean_accepted_tokens": null,
          "speedup_vs_baseline": 1.0
        }
      }
    },
    "vanilla_specdec": {
      "name": "Vanilla Speculative Decoding (No Retrieval)",
      "gamma": 8,
      "sweep": {
        "8192": {
          "prefill_length": 8192,
          "mean_latency_s": 45.80434799194336,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 5.588989063768105,
          "mean_accepted_tokens": 0.3882978723404255,
          "speedup_vs_baseline": 1.181014422642493
        },
        "16384": {
          "prefill_length": 16384,
          "mean_latency_s": 84.6671712398529,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 3.023604027997815,
          "mean_accepted_tokens": 0.2864321608040201,
          "speedup_vs_baseline": 1.1818726750719133
        },
        "24576": {
          "prefill_length": 24576,
          "mean_latency_s": 128.17797422409058,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 1.9972230139356169,
          "mean_accepted_tokens": 0.23333333333333334,
          "speedup_vs_baseline": 1.158516343751455
        },
        "32768": {
          "prefill_length": 32768,
          "mean_latency_s": 163.70840549468994,
          "std_latency_s": 0.0,
          "mean_throughput_tok_per_s": 1.5637559917978898,
          "mean_accepted_tokens": 0.24757281553398058,
          "speedup_vs_baseline": 1.194633805389533
        }
      }
    }
  }
}